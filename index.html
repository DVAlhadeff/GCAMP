<!DOCTYPE html> 
<html lang="en"> 
  <head> 
    <meta charset="utf-8"> 
    <meta http-equiv="X-UA-Compatible" content="IE=7,IE=9" /> 
	
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no"/> 
	<meta name="SKYPE_TOOLBAR" content="SKYPE_TOOLBAR_PARSER_COMPATIBLE" />
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
    <title>Georgia Coastal Atlas</title> 

    <link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.3/js/dojo/dijit/themes/tundra/tundra.css" /> 
	<link href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.3/js/dojo/dijit/themes/tundra/form/Button.css" rel="stylesheet"/>
	
	<link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.3/js/dojo/dojox/layout/resources/ExpandoPane.css"/>
    <link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.3/js/esri/dijit/css/Popup.css" />
	<link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.3/js/esri/css/esri.css" >  </link>

	<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" > </link>
	<link type="text/css" href="css/jquery.jscrollpane.css" rel="stylesheet" media="all" />
	<link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen"> </link>
	<link href="/bootstrap/css/bootstrap-responsive.css" rel="stylesheet"> </link>
	
	<link rel="stylesheet" type="text/css" href="./css/marco_style.css"> </link>
    <link rel="stylesheet" type="text/css" href="style.css">  </link>
	
    <style>
      #map{ margin: 0; padding: 0; } 
    </style> 
    <script>
	var dojoConfig = { parseOnLoad: true };
	/*
		packages : [
			{
				name : "my",
				location : "http://localhost/dijits/my"
			}
		]};*/
	</script> 

	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>

	
		<!-- the jScrollPane script -->
	<script type="text/javascript" src="script/jquery.mousewheel.js"></script>
	<script type="text/javascript" src="script/jquery.jscrollpane.js"></script>
	
		<script src='script/knockout-2.2.1.js'></script>
	<script src="/bootstrap/js/bootstrap.min.js"></script>
	
    <script src="http://serverapi.arcgisonline.com/jsapi/arcgis/3.3compact"></script>
	<script src="script/MapClasses.js" type="text/javascript"></script>
	
	<script src='metadata.js'> </script>
	<script src='attributes.js'> </script>
	<script src='visibility.js'> </script>
	<script src='query.js'> </script>
	<script src='map.js'> </script>
    <script src='main.js'> </script>
  </head> 
 
<body class="tundra" style='margin-top: 0px;'>
	<div id='wrap'>
		<div id='header' style='padding-top: 20px;'>
			<div id='BrandingPanel'>
				<!--img src='http://georgia.gov/profiles/georgiagov/themes/gagov/logo.png' alt='Georgia.gov Logo'/-->
				<span id='GABranding'>Georgia Coastal Atlas</span>
			</div>
			
			<div class='sidebar-nav' style='height: 3em;'>
				<ul class='nav nav-tabs'>
					<li> <a id='allLayersLink'>All Layers</a> </li>
					<li> <a id='energyLink' >Energy</a> </li>
					<li> <a id='fisheriesLink'>Fisheries</a> </li>
					<li> <a id='habitatLink'>Habitat</a> </li>
					<!-- <li> <a>Regulatory</a> </li> -->
				</ul>
			</div>
		</div>

		<div id='main' class='container-fluid'>
		<!--div class='row-fluid'-->
			<div class='span6' id='LeftPanel' style='height: 100%;'>
				<div style='height: 100%'>
					<div>
					<ul class='nav nav-tabs' id='myTab' style=''>
						<li><a title='Pan Map' id='panBtn' href='#' class='btn'
							data-bind='css: { currTool: true }'>
							<i class='icon zoompan'></i></a></li>
						<li><a title='Zoom In' id='zoomInBtn' href='#' class='btn'>
							<i class='icon zoomInIcon'></i></a></li>
						<li><a title='Zoom to Previous Extent' id='zoomPrevBtn' href='#'class='btn'>
							<i class='icon zoomprevIcon'></i></a></li>
						<li><a title='Zoom to Initial Extent' id='zoomFullExtBtn' href='#'class='btn'>
							<i class='icon zoomfullextIcon'></i></a></li>
						<li><a title='Measuring Tools' id='meas' href='#' class='btn'>
							<i class='icon measureLine'></i></a></li>
						<li><div id='printButton'></div> </li>
					</ul>
					<ul class='nav nav-tabs nav-stacked' id='myTab' style='width: 48px; float: right;'>
						<li class='active'><a title='Map Layers' href="#layersTab" data-toggle="tab" id='layerTabLink'>
							<i class='icon Layers-icon'></i></a></li>
						<li><a title='Basemaps' href="#basemapsTab" data-toggle="tab">
							<i class='icon base-layer-icon'></i></a></li>
						<li><a title='Add Map Services' href="#otherDataTab" data-toggle="tab">
							<i class='icon open-maplayer-icon'></i></a></li>
						<li><a title='Map Legend' href='#legendPane' data-toggle='tab'>
							<i class='icon map-legend-icon'></i></a></li>
						<li><a title='Identify Feature' href='#identifyPane' data-toggle='tab'>
							<i class='icon Identify-results'></i></a></li>
						<li><a title='' href='#metadataPane' id='mdtaLink' data-toggle='tab'>
							<i class='icon metadataTabIcon'></i></a></li>
					</ul>
					</div>

					<div class='tab-content' style='height: 100%;'>
						<div class='tab-pane active' id="layersTab" style='padding-left:1em; height: 95%;'>
							<h2>Data Layers</h2>
							<!--div data-bind="text: ly1.visibleLayers.length"></div-->
							<div class='scroll-pane metadataPane' style='overflow: auto; height: 95%; width: 100%;'>
								<!--div class=' style='padding-right: 1em; height:100%; width: 100%;'-->
									<div class='accordion' id='layersVisibList' data-bind="template: {name: 'layers_template', foreach: allMapLayers }">
									</div>
									
									<script type="text/html" id="layers_template">
										<!-- ko if: (children.length > 0) -->
											<div class='accordion-heading' data-bind="click : viewModel.setOpenTheme , css:{'active': true}">
												<div> <a class='accordion-toggle'>  <span data-bind='text: name'></span> </a> </div>
											</div>
											<div class='accordion-body collapse' data-bind="css: {'in': viewModel.isOpenTheme(name) }"
													style='margin-left: 20px; overflow: auto;'>
												<div class='scroll-pane' data-bind="template: {name: 'layers_template', foreach: children }" style='margin-right: 5px; width: 95%;'>
												</div>
											</div>
										<!-- /ko -->
										<!-- ko if: (children.length == 0) -->
											<div class='accordion-inner' style='width: 100%; scroll: auto;'>
												<div class='btn-group btn-group-layer'>
													<span class='btn btn-layer' style='padding-top: 0px; margin: 0px;' data-bind='click: viewModel.toggleVisibleLayer'>
														<i class='check icon-large icon-check'
														data-bind="visible: viewModel.isVisibleLayer(mapLayerId, seq) "
														style='padding: 4px; margin: 0px; width: 15px; background-image: url("images/glyphicons_152_check.png"); background-position: 0 0;'>
														</i>
														<i class='check icon-large icon-check'
														data-bind="visible: viewModel.isVisibleLayer(mapLayerId, seq) == false"
														style='padding: 4px; margin: 0px; width: 15px; background-image: url("images/glyphicons_153_unchecked.png"); background-position: 0 0;'>
														</i>
													</span>
													<!--a class='btn btn-info-sign'><i class='icon-info-sign icon-large'></i> </a-->
													<span class='btn btn-layer' data-bind='click:  dispMetadata' style='text-align: left;'><i class='icon Information-Icon'></i></span>
													<span class='btn btn-layer' data-bind='text: name, click: dispAttribTable' style='text-align:left; min-width: 12em;'></span>
												</div>
											</div>
										<!-- /ko -->
									</script>
								<!--/div -->
							</div>
						</div>
						<div class='tab-pane' id="basemapsTab" style='padding-left:1em;'>
							<h2>Basemaps</h2>
							<div style='padding-bottom: 2em;'><i class='btn' data-bind='click: return_to_LayerList'> Return to Layer list </i></div>
							
							<div id='basemapGallery'> </div>
						</div>
						<div class='tab-pane' id="otherDataTab" style='padding-left:1em;'>
							<h2>Add Data</h2>
							<div style='padding-bottom: 2em;'><i class='btn' data-bind='click: return_to_LayerList'> Return to Layer list </i></div>
							
							<h3>Available Map Services</h3>
							
							<div >
								<select id='SelectMapLayer' data-bind="options: mapLyrs, optionsText: 'mapLabel', value: mapLyrToRemove"> </select>
							</div>
				
							<button class="btn" id='MapSrvRemove' data-bind='click: do_remove_mapsvc'>Remove Service</button>

							<h4 style='margin-top: 20px;'>Add Map Service</h4>
							<div>
								<select id='AddMapSvcList' data-bind="options: mapSvrChoices, optionsText: 'mapLabel', value: selectedNewMapSvc"> </select>
							</div>
							
							<!--table>
								<tr>
									<td> <strong>Label:</strong> </td>
									<td> <input id='AddMapSvcLabel' data-dojo-type="dijit.form.ValidationTextBox" /> </td>
								</tr>
								<tr>
									<td> <strong>URL:</strong> </td>
									<td> <input id='AddMapSvcURL' data-dojo-type="dijit.form.ValidationTextBox" /> </td>
								</tr>
							</table-->
							
							<div id='SelectMapLayerCatalog'></div>
								<button class='btn' id='MapSrvAdd' data-bind='click: do_add_mapsvc' >Add Map Service </button> 
							</div>
						<div class='tab-pane' id='legendPane' style='padding-left:1em;'>
							<h2>Map Legend</h2>
							<div style='padding-bottom: 2em;'><i class='btn' data-bind='click: return_to_LayerList'> Return to Layer list </i></div>

							<div id='legendSection'></div>
						</div>
						<div class='tab-pane' id='resultsPane' style='padding-left:1em;'>
						</div>
						<div class='tab-pane' id='identifyPane'style='padding-left: 1em; padding-right: 1em; height: 90%;'>
							<h2>Identify</h2>
							<div style='padding-bottom: 2em;'><i class='btn' data-bind='click: return_to_LayerList'> Return to Layer list </i></div>
							
							<div style='height: 10%;'>
								<p>Click on the map to identify map attributes for particular features.</p>
								
								<!--p>
									<div>Identify Tolerance: </div>
									<div style='font-weight: bold;' data-bind="text: dispIDTolerance"></div>
								</p-->
							</div>
							
							<div id='' class='scroll-pane' style='height: 85%; width: 75%; overflow: auto;'>
									<!-- div id='idResultsList' -->
									<div id='idResultsList' data-bind="foreach: lastIdResults">
										<!-- h3 data-bind="text: $data[0].layerName"> </h3 -->
										
										<!-- table id='statTable'>
											<tr><th>Layer</th><th>Minimum</th><th>Maximum</th><th>Average</th></tr>
											<tr><td style='font-weight: bold;'> Tidal Power </td>
												<td data-bind='text: mean_curr().min'></td>
												<td data-bind='text: mean_curr().max'></td>
												<td data-bind='text: mean_curr().avg'></td></tr>
										</table-->
										
										<div class='accordion-heading' data-bind="click : idViewModel.setOpenTheme, css:{'active': true}">
											<div> <a class='accordion-toggle'>  <span data-bind='text: $data[0].layerName'></span> </a> </div>
										</div>
										<div class='accordion-body collapse' data-bind="css: {'in': idViewModel.isOpenTheme($data[0].layerName) }">
											<div class='accordion-inner'>
												<ul>
													<div data-bind="foreach: $data">
														<li style='padding-top: 0.8em;'><span data-bind="text: value"></span> <br/>
															<a data-bind="click: idViewModel.zoomToFeature " >Zoom to feature</a></li>
															<table>
																<thead>
																	<tr><th>Attribute</th><th>Value</th></tr>
																</thead>
																<tbody data-bind="foreach: getResultsFields($data)">
																	<tr>
																			<td><span data-bind="text: Name"></span></td>
																			<td><span data-bind="text: Value"></span></td>
																	</tr>
																</tbody>
															</table>
														</li>
													</div>
												</ul>
											</div>
										</div>
									</div>
							</div>
						</div>
						
						<!--div class='tab-pane' id='attribPane' style='padding-left:1em;'> </div-->
						<div class='tab-pane' id='metadataPane' style='padding-left:1em; height: 90%;'>
							<h2>Layer Metadata</h2>
							<div style='padding-bottom: 2em;'><i class='btn' data-bind='click: return_to_LayerList'> Return to Layer list </i></div>
						
							<h3 data-bind='text: lastMetadataLayerTitle'> </h3>
															
							<div class='tab-pane' id='metadataPane' style='padding-left:1em; height: 90%;'>
								
								<div class='accordion' id='infoAcc'>									
									<div class='accordion-heading'>
										<a class='accordion-toggle' data-toggle='collapse' data-parent='#infoAcc' href='#infoAccCollapse2'>Metadata</a>
									</div>
									<div class='collapse in' id='infoAccCollapse2' style='padding: 1em;'>
										<div style='overflow: auto; height: 80%; width: 90%;' class='' data-bind='text: lastMetadata' id='metaArea'>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class='span9' id='MapPanel' style='height: 100%;'>
				<div style='position: absolute; top: 24px;'>
					<!--a id='panBtn' href='#' class='btn'
						data-bind='css: { currTool: true }'> Pan </a>
					<a id='zoomInBtn' href='#' class='btn'> Zoom In </a> 
					<a id='zoomPrevBtn' href='#'class='btn'> Zoom to Previous Extent</a-->
				</div>
				<div id="map" style='height:100%;'> </div>
				<div style='position: absolute; top: 5px; z-index: 255; right: 2.5em;'>
					<img src='http://carto.gis.gatech.edu/ga-logo_dnr_09.jpg' alt='Georgia DNR Logo' style='height: 75px; margin-left: 4em;' />
					<img src='http://carto.gis.gatech.edu/CGIS_Logo_5.png' alt='Center for GIS Logo' style='height: 75px; margin-left: 4em;' />
				</div>
				<div style='position: absolute; bottom: 2px; z-index: 255; right: 2.5em;'>
					<div id='coordinates' class='button button-group'>
						Lat: <span data-bind='text: map_y_coord'></span> Long: <span data-bind='text: map_x_coord'></span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal hide fade" id='intro'>
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h3>Georgia Coastal Atlas</h3>
		</div>
		<div class="modal-body">
			<p>Prepared by the Center of GIS at Georgia Tech for the Georgia Department of Natural Resources Coastal Resources Division</p>
		</div>
		<div class="modal-footer">
			<a id='SplashCloseBtn' href="#" class="btn disabled" data-dismiss="modal" data-loading-text='Loading...'>Close</a>
		</div>
	</div>
	<div class="modal hide fade" id='metaError'>
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h3>Georgia Coastal Atlas: Metadata Lookup</h3>
		</div>
		<div class="modal-body">
			<p>No Metadata Found, or other error.</p>
		</div>
		<div class="modal-footer">
			<a href="#" class="btn" data-dismiss="modal">Close</a>
		</div>
	</div>
	<div class='' id='measurePopoutPanel'>
		<div id='measurementDiv'></div>
	</div>
	<div class='' id='timePopoutPanel'>
		<div id='timeSliderDiv'></div>
	</div>
	<div class='' style='height: 10em;' id='attribPopoutPanel'>
		<table>
			<thead>
			</thead>
			<tbody>
					<tr>
					<!-- ko foreach: lastAttribFields -->
						<th>
							<span data-bind='text: $data' ></span>
						</th>
					<!-- /ko -->
					</tr>
				<!-- ko foreach: lastAttribFeatures -->
					<tr class='attribRow' data-bind='click: doAttribZoom'>
						<!-- ko foreach: lastAttribFields -->
							<td data-bind='text: $parent[$data] '></td>
						<!-- /ko -->
					</tr>
				<!-- /ko -->
			</tbody>
		</table>
	</div>
</body>
</html>